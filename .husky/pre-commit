#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# 1. ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
echo "ğŸ“ Checking code style..."
npm run check
if [ $? -ne 0 ]; then
  echo "âŒ Code style check failed. Run 'npm run check:write' to fix."
  exit 1
fi

# 2. å‹ãƒã‚§ãƒƒã‚¯
echo "ğŸ”§ Type checking..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ Type check failed. Fix type errors before committing."
  exit 1
fi

# 3. å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆå¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
echo "ğŸ§ª Running unit tests..."
npm run test:unit -- --run --reporter=verbose
if [ $? -ne 0 ]; then
  echo "âŒ Unit tests failed. Fix failing tests before committing."
  exit 1
fi

echo "âœ… All pre-commit checks passed!"
