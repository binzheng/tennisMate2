#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¤œè¨¼
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

echo "ğŸ“ Validating commit message..."

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç©ºã§ãªã„ã“ã¨ã‚’ç¢ºèª
if [ -z "$commit_msg" ]; then
  echo "âŒ Commit message cannot be empty."
  exit 1
fi

# æ¨å¥¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ãƒã‚§ãƒƒã‚¯ï¼ˆç·©ã„æ¤œè¨¼ï¼‰
# ä¾‹: "feat: add user authentication" ã¾ãŸã¯ "fix: resolve login issue"
if ! echo "$commit_msg" | grep -qE "^(feat|fix|refactor|test|docs|style|chore|perf|ci|build|revert)(\(.+\))?: .+"; then
  echo "âš ï¸  Warning: Commit message does not follow conventional format."
  echo "   Recommended format: <type>: <subject>"
  echo "   Types: feat, fix, refactor, test, docs, style, chore, perf, ci, build, revert"
  echo ""
  echo "   Example: feat: add user authentication"
  echo ""
  echo "   Proceeding anyway..."
fi

echo "âœ… Commit message validated!"
